# 1D对流扩散问题数值求解与验证报告

## 问题描述

本报告针对一维稳态对流扩散方程进行数值求解和验证：

**控制方程：** 
```
- d²T/dx² + Pe * dT/dx = 0
```

**边界条件：**
- T(0) = 1 (West边界)
- T(1) = 0 (East边界)

其中 Peclet 数 Pe = ρ*u*L/k

## 四个工况设置

| 工况 | 网格数 | 速度 u | Peclet数 | 物理意义 |
|------|--------|--------|----------|----------|
| 1    | 5      | 0.1    | 1.0      | 低Pe数，粗网格 |
| 2    | 5      | 2.5    | 25.0     | 高Pe数，粗网格 |
| 3    | 20     | 0.1    | 1.0      | 低Pe数，细网格 |
| 4    | 20     | 2.5    | 25.0     | 高Pe数，细网格 |

## 解析解推导

对于一维稳态对流扩散方程：
```
- d²T/dx² + Pe * dT/dx = 0
```

积分两次得到通解：
```
T(x) = C₁ + C₂ * exp(Pe * x)
```

应用边界条件：
```
T(0) = C₁ + C₂ = T_W
T(1) = C₁ + C₂ * exp(Pe) = T_E
```

解得：
```
T(x) = T_W + (T_E - T_W) * (exp(Pe * x) - 1) / (exp(Pe) - 1)
```

## 数值方法

采用有限体积法离散，使用中心差分格式：

- **扩散项：** 中心差分
- **对流项：** 中心差分
- **求解器：** 高斯消去法

## 结果分析

### 1. 误差分析表

| 工况 | 网格数 | 速度 | Pe数 | 最大绝对误差 | 最大相对误差(%) | L2误差 |
|------|--------|------|------|-------------|----------------|--------|
| 1    | 5      | 0.1  | 1.0  | 0.007345    | 4.879          | 0.005449 |
| 2    | 5      | 2.5  | 25.0 | 1.546457    | 168.475        | 0.760948 |
| 3    | 20     | 0.1  | 1.0  | 0.000485    | 1.243          | 0.000341 |
| 4    | 20     | 2.5  | 25.0 | 0.160266    | 34.485         | 0.039240 |

### 2. 关键观察

#### 网格收敛性分析
- **低Pe数 (Pe=1.0)**：网格加密显著提高精度
  - 5网格 → 20网格：误差从0.007345降至0.000485 (约15倍改善)
  - L2误差从0.005449降至0.000341 (约16倍改善)

- **高Pe数 (Pe=25.0)**：网格加密仍然有效，但改善幅度较小
  - 5网格 → 20网格：误差从1.546457降至0.160266 (约9.6倍改善)
  - L2误差从0.760948降至0.039240 (约19倍改善)

#### Peclet数影响分析
- **低Pe数 (Pe=1.0)**：扩散主导，数值解与解析解吻合良好
- **高Pe数 (Pe=25.0)**：对流主导，出现数值振荡现象
  - 粗网格(5节点)：相对误差高达168.475%
  - 细网格(20节点)：相对误差仍为34.485%，但显著改善

### 3. 物理现象解释

#### 边界层效应
- 高Pe数情况下，在右边界(x=1)附近形成陡峭的温度梯度
- 中心差分格式在高Pe数时容易出现数值振荡
- 需要更细的网格或更高阶的离散格式来准确捕捉边界层

#### 数值扩散
- 中心差分格式在低Pe数时表现良好
- 高Pe数时，数值扩散可能导致非物理振荡

## 验证结论

### 1. 方法验证
✅ **数值方法正确性确认**
- 低Pe数情况下，数值解与解析解高度一致
- 网格收敛性表现良好
- 残差均接近机器精度(1e-16量级)

### 2. 局限性识别
⚠️ **高Pe数问题的挑战**
- 中心差分格式在高Re数时稳定性问题
- 需要采用更robust的离散格式(如迎风格式、QUICK等)
- 网格要求极高，计算成本增加

### 3. 改进建议

#### 离散格式改进
- **迎风格式(Upwind)**：提高稳定性，但增加数值扩散
- **混合格式(Hybrid)**：根据局部Peclet数自动选择格式
- **QUICK格式**：三阶精度，平衡精度和稳定性

#### 网格策略
- **边界层加密**：在高梯度区域使用非均匀网格
- **自适应网格**：根据解的梯度自动调整网格密度

#### 求解器优化
- **迭代求解器**：对于大规模问题更高效
- **多重网格方法**：加速收敛

## 文件清单

### 源代码文件
- `1d_cd.h` - 类定义头文件
- `1d_cd.cpp` - 有限体积法实现
- `main.cpp` - 主程序，处理四个工况
- `visualize_results.py` - Python可视化脚本

### 参数文件
- `case1_params.json` - 工况1参数
- `case2_params.json` - 工况2参数  
- `case3_params.json` - 工况3参数
- `case4_params.json` - 工况4参数

### 结果文件
- `case1_results.txt` - 工况1数值解
- `case2_results.txt` - 工况2数值解
- `case3_results.txt` - 工况3数值解
- `case4_results.txt` - 工况4数值解
- `convection_diffusion_comparison.png` - 对比图表(PNG格式)
- `convection_diffusion_comparison.pdf` - 对比图表(PDF格式)

## 总结

本研究成功实现了一维对流扩散方程的有限体积法求解，并通过与解析解的对比验证了方法的正确性。主要结论：

1. **低Pe数问题**：中心差分格式表现优异，数值解与解析解高度吻合
2. **高Pe数问题**：需要改进离散格式或加密网格来获得准确解
3. **网格收敛性**：所有工况都表现出良好的网格收敛特性
4. **方法可靠性**：通过残差分析和误差验证确认了数值方法的可靠性

该工作为进一步研究复杂流动传热问题奠定了基础，展示了数值方法验证的重要性和局限性。
